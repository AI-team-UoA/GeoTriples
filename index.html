<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>GeoTriples by LinkedEOData</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">GeoTriples</h1>
      <h2 class="project-tagline"> Publishing geospatial data as Linked Open Geospatial Data </h2>
      <a href="https://github.com/LinkedEOData/GeoTriples" class="btn">View on GitHub</a>
      <a href="https://github.com/LinkedEOData/GeoTriples/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/LinkedEOData/GeoTriples/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="geotriples" class="anchor" href="#geotriples" aria-hidden="true"><span class="octicon octicon-link"></span></a>GeoTriples</h1>

<p>Publishing geospatial data as Linked Open Geospatial Data </p>
<a href="spec">Specification</a>
<h2>
<a id="quickstart" class="anchor" href="#quickstart" aria-hidden="true"><span class="octicon octicon-link"></span></a>Quickstart</h2>

<p>Assuming git, <a href="http://maven.apache.org/download.cgi">Maven</a> and <a href="https://www.java.com/en/download/">Java</a> installed:</p>

<div class="highlight highlight-source-shell"><pre>$ git clone https://github.com/LinkedEOData/GeoTriples.git
$ <span class="pl-c1">cd</span> GeoTriples
$ mvn package
$ java -jar target/geotriples-<span class="pl-k">&lt;</span>version<span class="pl-k">&gt;</span>-cmd.jar [Options] [Argument]

[Optional: Add an <span class="pl-c1">alias</span> <span class="pl-k">for</span> <span class="pl-smi">executing</span> the jar file with <span class="pl-c1">command</span> <span class="pl-s"><span class="pl-pds">`</span>geotriples-cmd<span class="pl-pds">`</span></span>]
$ <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>alias geotriples-cmd='java -jar <span class="pl-s"><span class="pl-pds">`</span><span class="pl-c1">pwd</span><span class="pl-pds">`</span></span>/target/geotriples-&lt;version&gt;-cmd.jar'<span class="pl-pds">"</span></span> <span class="pl-k">&gt;&gt;</span> <span class="pl-k">~</span>/.bashrc</pre></div>

<h3>
<a id="geotriples-modes" class="anchor" href="#geotriples-modes" aria-hidden="true"><span class="octicon octicon-link"></span></a>GeoTriples Modes</h3>

<p>GeoTriples consists of three modules. The Mapping Generator which automatically produces an R2RML/RML mapping file according to the input source's schema, the R2RML/RML processor which processes an R2RML/RML mapping and generates an RDF graph, and finally the Ontology Based Data Access (OBDA) module that evaluates stSPARQL/GeoSPARQL queries over a relational database.</p>

<h4>
<a id="automatic-generation-of-r2rmlrml-mappings" class="anchor" href="#automatic-generation-of-r2rmlrml-mappings" aria-hidden="true"><span class="octicon octicon-link"></span></a>Automatic generation of R2RML/RML mappings</h4>

<ul>
<li>Relational Database </li>
</ul>

<div class="highlight highlight-source-shell"><pre>$ geotriples-cmd generate_mapping -b baseURI [-u user] [-p password] [-d driver] [-o mappingFile] [-rml] jdbcURL</pre></div>

<ul>
<li>Shapefile</li>
</ul>

<div class="highlight highlight-source-shell"><pre>$ geotriples-cmd generate_mapping -b baseURI [-o mappingFile] [-rml] fileURL</pre></div>

<ul>
<li>XML files (Only RML mappings)</li>
</ul>

<div class="highlight highlight-source-shell"><pre>$ geotriples-cmd generate_mapping -b baseURI [-o RMLmappingFile] [-rp rootpath] [-r rootelement] [-onlyns namespace] [-ns namespaces] [-x XSDfile] fileURL</pre></div>

<h4>
<a id="transformation-into-rdf" class="anchor" href="#transformation-into-rdf" aria-hidden="true"><span class="octicon octicon-link"></span></a>Transformation into RDF</h4>

<ul>
<li>Relational Database</li>
</ul>

<div class="highlight highlight-source-shell"><pre>$ geotriples-cmd dump_rdf [-rml] [-f format] [-b baseURI] [-o rdfoutfile]  -u user -p password -d driver -j jdbcURL inputmappingfile</pre></div>

<ul>
<li>Shapefile</li>
</ul>

<div class="highlight highlight-source-shell"><pre>$ geotriples-cmd dump_rdf [-rml] [-f format] [-b baseURI] [-o rdfoutfile] [-s epsgcode] [-sh fileURL] inputmappingfile</pre></div>

<ul>
<li>XML/JSON (using RML processor)</li>
</ul>

<div class="highlight highlight-source-shell"><pre>$ geotriples-cmd dump_rdf  -rml [-f format] [-b baseURI] [-o rdfoutfile] [-s epsgcode] inputRMLmappingfile</pre></div>

<h3>
<a id="geotriples-architecture" class="anchor" href="#geotriples-architecture" aria-hidden="true"><span class="octicon octicon-link"></span></a>GeoTriples Architecture</h3>

<p>GeoTriples comprises three main
components: the mapping generator, R2RML/RML processor and the <a href="https://github.com/ConstantB/ontop-spatial">ontop-spatial</a> OBDA evaluator. The mapping
generator takes as input a data source and creates automatically an R2RML or RML
mapping that transforms it into an RDF graph. The generated mapping is
enriched with subject and predicate-object maps, in order to take into account
the specifities of geospatial data and cater for all transformations that are
needed to produce an RDF graph that is compliant with the GeoSPARQL
vocabulary. To accomplish this task, we extend R2RML mappings to allow
the representation of a transformation function over input data. Afterwards,
the user may edit the generated R2RML mapping document to comply with
her requirements (e.g., use a different vocabulary).</p>

<p><img src="http://drive.google.com/uc?export=view&amp;id=0ByyHFR-5IXfpdHhWOERNNUxsNVE" alt="Architecture" title="The architecture of GeoTriples"></p>

<h3>
<a id="rml-processor" class="anchor" href="#rml-processor" aria-hidden="true"><span class="octicon octicon-link"></span></a>RML Processor</h3>

<p>GeoTriples now supports the <a href="http://rml.io/">RML</a> mapping language by extending the <a href="https://github.com/mmlab/RMLProcessor">RML processor</a> to address the spatial information.
<a href="http://rml.io/">RML</a> is a mapping language, very similar to <a href="http://www.w3.org/TR/r2rml/">R2RML</a>. The main difference is that RML is designed to allow the process of data that <em>do not necessarily</em> rely in tables and thus not having an explicit iteration pattern.</p>

<p>For example, the farms.xml (see below) cannot be iterated in per row fashion, because it has nested elements.</p>

<div class="highlight highlight-text-xml"><pre>&lt;<span class="pl-ent">Farm</span>&gt;
   &lt;<span class="pl-ent">Field</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>1<span class="pl-pds">"</span></span>&gt;
      &lt;<span class="pl-ent">Vigor</span>&gt;4&lt;/<span class="pl-ent">Vigor</span>&gt;
      &lt;<span class="pl-ent">Farmer</span>&gt;John Vl&lt;/<span class="pl-ent">Farmer</span>&gt;
      &lt;<span class="pl-ent">Geometry</span>&gt;
       &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">Polygon</span>&gt;
         &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">outerBoundaryIs</span>&gt;
           &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">LinearRing</span>&gt; 
             &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">posList</span>&gt;0,0 100,0 100,100 0,100 0,0&lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">posList</span>&gt; 
           &lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">LinearRing</span>&gt;
         &lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">outerBoundaryIs</span>&gt;
       &lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">Polygon</span>&gt;
      &lt;/<span class="pl-ent">Geometry</span>&gt;
   &lt;/<span class="pl-ent">Field</span>&gt;
   &lt;<span class="pl-ent">Field</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span>&gt;
      &lt;<span class="pl-ent">Vigor</span>&gt;1&lt;/<span class="pl-ent">Vigor</span>&gt;
      &lt;<span class="pl-ent">Farmer</span>&gt;Harper Lee&lt;/<span class="pl-ent">Farmer</span>&gt;
      &lt;<span class="pl-ent">Geometry</span> <span class="pl-e">id</span>=1&gt;
       &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">Polygon</span>&gt;
         &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">outerBoundaryIs</span>&gt;
           &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">LinearRing</span>&gt; 
             &lt;<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">posList</span>&gt;100,100 200,100 200,200 100,200 100,100&lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">posList</span>&gt;
           &lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">LinearRing</span>&gt;
         &lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">outerBoundaryIs</span>&gt;
       &lt;/<span class="pl-ent">gml</span><span class="pl-ent">:</span><span class="pl-ent">Polygon</span>&gt;
      &lt;/<span class="pl-ent">Geometry</span>&gt;
   &lt;/<span class="pl-ent">Field</span>&gt;
   &lt;<span class="pl-ent">Field</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">"</span>3<span class="pl-pds">"</span></span>&gt;
      &lt;<span class="pl-ent">Vigor</span>&gt;3&lt;/<span class="pl-ent">Vigor</span>&gt;
      &lt;<span class="pl-ent">Farmer</span>&gt;Bruce Pom&lt;/<span class="pl-ent">Farmer</span>&gt;
   &lt;/<span class="pl-ent">Field</span>&gt;
&lt;/<span class="pl-ent">Farm</span>&gt;</pre></div>

<p>R2RML uses the property <code>rr:tableName</code> to define which table from the input file or the relational database it going to be used as the source table for the mappings. RML has the equivalent <code>rml:source</code> to define the source for the mappings. The source can be a JDBC URL for a relational database, a Shapefile, an XML, JSON or CSV file. 
The iterator property <code>rml:iterator</code> defines the iterating pattern in order to process non-relational structured files. For the above example the iterator should be an XPath query.</p>

<p>An example RML mapping can be the following</p>

<pre><code>&lt;#Field&gt;
    rml:logicalSource [
     rml:source "/fields.xml";
     rml:referenceFormulation ql:XPath;
     rml:iterator "/Farm/Field"];

    rr:subjectMap [ 
     rr:class ont:Farm; 
     rr:class ogc:Feature;
     rr:template "http://data.linkedeodata.eu/Field/id/{@id}"];

    rr:predicateObjectMap [ 
     rr:predicate ont:hasVigor; 
     rr:objectMap [
       rml:reference "Vigor"]];

    rr:predicateObjectMap [ 
     rr:predicate ont:hasFarmer;
     rr:objectMap [ 
       rml:reference "Farmer"]].

    rr:predicateObjectMap [ 
     rr:predicate ogc:hasGeometry;
     rr:objectMap [ 
       rr:template "http://data.linkedeodata.eu/FieldGeometry/id/{Geometry/@id}"]].

&lt;#FieldGeometry&gt;
    rml:logicalSource [
     rml:source "/fields.xml";
     rml:referenceFormulation ql:XPath;
     rml:iterator "/Farm/Field/Geometry"];

    rr:subjectMap [ 
     rr:class ont:FieldGeometry; 
     rr:class ogc:Geometry
     rr:template "http://data.linkedeodata.eu/FieldGeometry/id/{@id}"];

    rr:predicateObjectMap [ 
     rr:predicate ogc:dimension; 
     rr:objectMap [
       rrx:function rrxf:dimension;
       rrx:argumentMap ([rml:reference "*"]) ];

    rr:predicateObjectMap [ 
     rr:predicate ogc:asWKT; 
     rr:objectMap [
       rrx:function rrxf:asWKT;
       rrx:argumentMap ([rml:reference "*"]) ].
</code></pre>

<p>This mapping contains two triples maps: &lt;#Field&gt; and &lt;#FieldGeometry&gt;. Both triples maps uses an XPath iterator, denoted by <code>rml:referenceFormulation</code>, as the base iterator pattern that will be used by the mapping processor module for the generation of the graph. The <code>rml:reference</code> is used instead of <code>rr:column</code> R2RML's property . The value of <code>rml:reference</code> property extends the iterator in order to point at an element.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/LinkedEOData/GeoTriples">GeoTriples</a> is maintained by <a href="https://github.com/LinkedEOData">LinkedEOData</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
